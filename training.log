nohup: ignoring input
Loading and preparing data...
Loading tokenizer and model for './bert-base-chinese-local'...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at ./bert-base-chinese-local and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Setting up training arguments...
Starting training...
  0%|          | 0/585 [00:00<?, ?it/s]/home/dinghanchen/anaconda3/envs/nlp_project/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
  0%|          | 1/585 [00:01<11:07,  1.14s/it]  0%|          | 2/585 [00:01<06:04,  1.60it/s]  1%|          | 3/585 [00:01<04:26,  2.19it/s]  1%|          | 4/585 [00:01<03:41,  2.62it/s]  1%|          | 5/585 [00:02<03:15,  2.97it/s]  1%|          | 6/585 [00:02<03:03,  3.15it/s]  1%|          | 7/585 [00:02<02:53,  3.34it/s]  1%|▏         | 8/585 [00:02<02:47,  3.45it/s]  2%|▏         | 9/585 [00:03<02:41,  3.57it/s]  2%|▏         | 10/585 [00:03<02:36,  3.67it/s]                                                {'loss': 1.1687, 'grad_norm': 21.53635025024414, 'learning_rate': 9e-07, 'epoch': 0.05}
  2%|▏         | 10/585 [00:03<02:36,  3.67it/s]  2%|▏         | 11/585 [00:03<02:33,  3.74it/s]  2%|▏         | 12/585 [00:04<02:31,  3.78it/s]  2%|▏         | 13/585 [00:04<02:33,  3.73it/s]  2%|▏         | 14/585 [00:04<02:31,  3.78it/s]  3%|▎         | 15/585 [00:04<02:29,  3.80it/s]  3%|▎         | 16/585 [00:05<02:27,  3.87it/s]  3%|▎         | 17/585 [00:05<02:27,  3.84it/s]  3%|▎         | 18/585 [00:05<02:30,  3.78it/s]  3%|▎         | 19/585 [00:05<02:30,  3.76it/s]  3%|▎         | 20/585 [00:06<02:29,  3.78it/s]                                                {'loss': 0.9694, 'grad_norm': 10.478342056274414, 'learning_rate': 1.9e-06, 'epoch': 0.1}
  3%|▎         | 20/585 [00:06<02:29,  3.78it/s]  4%|▎         | 21/585 [00:06<02:29,  3.78it/s]  4%|▍         | 22/585 [00:06<02:29,  3.77it/s]  4%|▍         | 23/585 [00:06<02:28,  3.79it/s]  4%|▍         | 24/585 [00:07<02:27,  3.81it/s]  4%|▍         | 25/585 [00:07<02:26,  3.82it/s]  4%|▍         | 26/585 [00:07<02:25,  3.83it/s]  5%|▍         | 27/585 [00:07<02:25,  3.83it/s]  5%|▍         | 28/585 [00:08<02:27,  3.77it/s]  5%|▍         | 29/585 [00:08<02:25,  3.82it/s]  5%|▌         | 30/585 [00:08<02:25,  3.81it/s]                                                {'loss': 0.7816, 'grad_norm': 10.776100158691406, 'learning_rate': 2.9e-06, 'epoch': 0.15}
  5%|▌         | 30/585 [00:08<02:25,  3.81it/s]  5%|▌         | 31/585 [00:09<02:24,  3.83it/s]  5%|▌         | 32/585 [00:09<02:25,  3.81it/s]  6%|▌         | 33/585 [00:09<02:25,  3.80it/s]  6%|▌         | 34/585 [00:09<02:24,  3.80it/s]  6%|▌         | 35/585 [00:10<02:24,  3.80it/s]  6%|▌         | 36/585 [00:10<02:28,  3.71it/s]  6%|▋         | 37/585 [00:10<02:25,  3.75it/s]  6%|▋         | 38/585 [00:10<02:25,  3.77it/s]  7%|▋         | 39/585 [00:11<02:24,  3.77it/s]  7%|▋         | 40/585 [00:11<02:23,  3.81it/s]                                                {'loss': 0.661, 'grad_norm': 4.726836681365967, 'learning_rate': 3.9e-06, 'epoch': 0.21}
  7%|▋         | 40/585 [00:11<02:23,  3.81it/s]  7%|▋         | 41/585 [00:11<02:22,  3.82it/s]  7%|▋         | 42/585 [00:11<02:24,  3.77it/s]  7%|▋         | 43/585 [00:12<02:23,  3.77it/s]  8%|▊         | 44/585 [00:12<02:24,  3.75it/s]  8%|▊         | 45/585 [00:12<02:21,  3.81it/s]  8%|▊         | 46/585 [00:12<02:22,  3.79it/s]  8%|▊         | 47/585 [00:13<02:22,  3.77it/s]  8%|▊         | 48/585 [00:13<02:21,  3.79it/s]  8%|▊         | 49/585 [00:13<02:20,  3.82it/s]  9%|▊         | 50/585 [00:14<02:19,  3.82it/s]                                                {'loss': 0.5812, 'grad_norm': 6.466210842132568, 'learning_rate': 4.9000000000000005e-06, 'epoch': 0.26}
  9%|▊         | 50/585 [00:14<02:19,  3.82it/s]  9%|▊         | 51/585 [00:14<02:18,  3.85it/s]  9%|▉         | 52/585 [00:14<02:17,  3.88it/s]  9%|▉         | 53/585 [00:14<02:18,  3.85it/s]  9%|▉         | 54/585 [00:15<02:18,  3.84it/s]  9%|▉         | 55/585 [00:15<02:19,  3.80it/s] 10%|▉         | 56/585 [00:15<02:19,  3.81it/s] 10%|▉         | 57/585 [00:15<02:18,  3.81it/s] 10%|▉         | 58/585 [00:16<02:16,  3.86it/s] 10%|█         | 59/585 [00:16<02:16,  3.86it/s] 10%|█         | 60/585 [00:16<02:15,  3.88it/s]                                                {'loss': 0.5348, 'grad_norm': 5.130946636199951, 'learning_rate': 5.9e-06, 'epoch': 0.31}
 10%|█         | 60/585 [00:16<02:15,  3.88it/s] 10%|█         | 61/585 [00:16<02:15,  3.86it/s] 11%|█         | 62/585 [00:17<02:16,  3.82it/s] 11%|█         | 63/585 [00:17<02:16,  3.81it/s] 11%|█         | 64/585 [00:17<02:17,  3.80it/s] 11%|█         | 65/585 [00:17<02:17,  3.78it/s] 11%|█▏        | 66/585 [00:18<02:18,  3.74it/s] 11%|█▏        | 67/585 [00:18<02:17,  3.76it/s] 12%|█▏        | 68/585 [00:18<02:14,  3.83it/s] 12%|█▏        | 69/585 [00:19<02:14,  3.84it/s] 12%|█▏        | 70/585 [00:19<02:13,  3.86it/s]                                                {'loss': 0.4841, 'grad_norm': 4.040379524230957, 'learning_rate': 6.900000000000001e-06, 'epoch': 0.36}
 12%|█▏        | 70/585 [00:19<02:13,  3.86it/s] 12%|█▏        | 71/585 [00:19<02:14,  3.82it/s] 12%|█▏        | 72/585 [00:19<02:14,  3.82it/s] 12%|█▏        | 73/585 [00:20<02:12,  3.85it/s] 13%|█▎        | 74/585 [00:20<02:12,  3.87it/s] 13%|█▎        | 75/585 [00:20<02:10,  3.90it/s] 13%|█▎        | 76/585 [00:20<02:09,  3.93it/s] 13%|█▎        | 77/585 [00:21<02:11,  3.88it/s] 13%|█▎        | 78/585 [00:21<02:10,  3.88it/s] 14%|█▎        | 79/585 [00:21<02:11,  3.84it/s] 14%|█▎        | 80/585 [00:21<02:11,  3.84it/s]                                                {'loss': 0.3492, 'grad_norm': 6.878340244293213, 'learning_rate': 7.9e-06, 'epoch': 0.41}
 14%|█▎        | 80/585 [00:21<02:11,  3.84it/s] 14%|█▍        | 81/585 [00:22<02:10,  3.87it/s] 14%|█▍        | 82/585 [00:22<02:10,  3.85it/s] 14%|█▍        | 83/585 [00:22<02:10,  3.85it/s] 14%|█▍        | 84/585 [00:22<02:07,  3.91it/s] 15%|█▍        | 85/585 [00:23<02:08,  3.88it/s] 15%|█▍        | 86/585 [00:23<02:08,  3.89it/s] 15%|█▍        | 87/585 [00:23<02:08,  3.88it/s] 15%|█▌        | 88/585 [00:23<02:09,  3.84it/s] 15%|█▌        | 89/585 [00:24<02:08,  3.85it/s] 15%|█▌        | 90/585 [00:24<02:08,  3.85it/s]                                                {'loss': 0.287, 'grad_norm': 9.69675064086914, 'learning_rate': 8.9e-06, 'epoch': 0.46}
 15%|█▌        | 90/585 [00:24<02:08,  3.85it/s] 16%|█▌        | 91/585 [00:24<02:07,  3.87it/s] 16%|█▌        | 92/585 [00:24<02:07,  3.87it/s] 16%|█▌        | 93/585 [00:25<02:07,  3.86it/s] 16%|█▌        | 94/585 [00:25<02:05,  3.90it/s] 16%|█▌        | 95/585 [00:25<02:08,  3.82it/s] 16%|█▋        | 96/585 [00:25<02:07,  3.84it/s] 17%|█▋        | 97/585 [00:26<02:05,  3.88it/s] 17%|█▋        | 98/585 [00:26<02:06,  3.86it/s] 17%|█▋        | 99/585 [00:26<02:08,  3.79it/s] 17%|█▋        | 100/585 [00:27<02:06,  3.83it/s]                                                 {'loss': 0.3239, 'grad_norm': 9.855644226074219, 'learning_rate': 9.900000000000002e-06, 'epoch': 0.51}
 17%|█▋        | 100/585 [00:27<02:06,  3.83it/s] 17%|█▋        | 101/585 [00:27<02:08,  3.78it/s] 17%|█▋        | 102/585 [00:27<02:06,  3.81it/s] 18%|█▊        | 103/585 [00:27<02:07,  3.78it/s] 18%|█▊        | 104/585 [00:28<02:06,  3.79it/s] 18%|█▊        | 105/585 [00:28<02:06,  3.81it/s] 18%|█▊        | 106/585 [00:28<02:04,  3.84it/s] 18%|█▊        | 107/585 [00:28<02:06,  3.78it/s] 18%|█▊        | 108/585 [00:29<02:04,  3.83it/s] 19%|█▊        | 109/585 [00:29<02:03,  3.87it/s] 19%|█▉        | 110/585 [00:29<02:03,  3.83it/s]                                                 {'loss': 0.3439, 'grad_norm': 10.68373966217041, 'learning_rate': 1.09e-05, 'epoch': 0.56}
 19%|█▉        | 110/585 [00:29<02:03,  3.83it/s] 19%|█▉        | 111/585 [00:29<02:04,  3.82it/s] 19%|█▉        | 112/585 [00:30<02:03,  3.83it/s] 19%|█▉        | 113/585 [00:30<02:02,  3.84it/s] 19%|█▉        | 114/585 [00:30<02:01,  3.88it/s] 20%|█▉        | 115/585 [00:30<02:01,  3.86it/s] 20%|█▉        | 116/585 [00:31<02:00,  3.88it/s] 20%|██        | 117/585 [00:31<01:59,  3.90it/s] 20%|██        | 118/585 [00:31<02:00,  3.89it/s] 20%|██        | 119/585 [00:31<01:59,  3.89it/s] 21%|██        | 120/585 [00:32<02:00,  3.85it/s]                                                 {'loss': 0.2089, 'grad_norm': 3.8858747482299805, 'learning_rate': 1.19e-05, 'epoch': 0.62}
 21%|██        | 120/585 [00:32<02:00,  3.85it/s] 21%|██        | 121/585 [00:32<02:00,  3.85it/s] 21%|██        | 122/585 [00:32<02:01,  3.82it/s] 21%|██        | 123/585 [00:33<02:00,  3.84it/s] 21%|██        | 124/585 [00:33<02:00,  3.82it/s] 21%|██▏       | 125/585 [00:33<01:59,  3.84it/s] 22%|██▏       | 126/585 [00:33<02:00,  3.81it/s] 22%|██▏       | 127/585 [00:34<01:59,  3.85it/s] 22%|██▏       | 128/585 [00:34<01:59,  3.83it/s] 22%|██▏       | 129/585 [00:34<01:59,  3.80it/s] 22%|██▏       | 130/585 [00:34<01:59,  3.81it/s]                                                 {'loss': 0.2842, 'grad_norm': 8.266740798950195, 'learning_rate': 1.29e-05, 'epoch': 0.67}
 22%|██▏       | 130/585 [00:34<01:59,  3.81it/s] 22%|██▏       | 131/585 [00:35<01:58,  3.84it/s] 23%|██▎       | 132/585 [00:35<01:57,  3.86it/s] 23%|██▎       | 133/585 [00:35<01:56,  3.87it/s] 23%|██▎       | 134/585 [00:35<01:56,  3.87it/s] 23%|██▎       | 135/585 [00:36<01:56,  3.88it/s] 23%|██▎       | 136/585 [00:36<01:55,  3.88it/s] 23%|██▎       | 137/585 [00:36<01:55,  3.89it/s] 24%|██▎       | 138/585 [00:36<01:54,  3.89it/s] 24%|██▍       | 139/585 [00:37<01:54,  3.89it/s] 24%|██▍       | 140/585 [00:37<01:54,  3.90it/s]                                                 {'loss': 0.223, 'grad_norm': 8.903132438659668, 'learning_rate': 1.3900000000000002e-05, 'epoch': 0.72}
 24%|██▍       | 140/585 [00:37<01:54,  3.90it/s] 24%|██▍       | 141/585 [00:37<01:54,  3.89it/s] 24%|██▍       | 142/585 [00:37<01:53,  3.89it/s] 24%|██▍       | 143/585 [00:38<01:55,  3.84it/s] 25%|██▍       | 144/585 [00:38<01:54,  3.85it/s] 25%|██▍       | 145/585 [00:38<01:55,  3.82it/s] 25%|██▍       | 146/585 [00:39<01:56,  3.76it/s] 25%|██▌       | 147/585 [00:39<01:56,  3.77it/s] 25%|██▌       | 148/585 [00:39<01:55,  3.78it/s] 25%|██▌       | 149/585 [00:39<01:53,  3.83it/s] 26%|██▌       | 150/585 [00:40<01:53,  3.82it/s]                                                 {'loss': 0.2361, 'grad_norm': 5.175809860229492, 'learning_rate': 1.49e-05, 'epoch': 0.77}
 26%|██▌       | 150/585 [00:40<01:53,  3.82it/s] 26%|██▌       | 151/585 [00:40<01:54,  3.78it/s] 26%|██▌       | 152/585 [00:40<01:53,  3.81it/s] 26%|██▌       | 153/585 [00:40<01:52,  3.85it/s] 26%|██▋       | 154/585 [00:41<01:52,  3.84it/s] 26%|██▋       | 155/585 [00:41<01:52,  3.83it/s] 27%|██▋       | 156/585 [00:41<01:50,  3.87it/s] 27%|██▋       | 157/585 [00:41<01:50,  3.89it/s] 27%|██▋       | 158/585 [00:42<01:52,  3.80it/s] 27%|██▋       | 159/585 [00:42<01:52,  3.80it/s] 27%|██▋       | 160/585 [00:42<01:51,  3.80it/s]                                                 {'loss': 0.2555, 'grad_norm': 10.13874340057373, 'learning_rate': 1.59e-05, 'epoch': 0.82}
 27%|██▋       | 160/585 [00:42<01:51,  3.80it/s] 28%|██▊       | 161/585 [00:42<01:50,  3.84it/s] 28%|██▊       | 162/585 [00:43<01:49,  3.86it/s] 28%|██▊       | 163/585 [00:43<01:49,  3.87it/s] 28%|██▊       | 164/585 [00:43<01:49,  3.84it/s] 28%|██▊       | 165/585 [00:43<01:50,  3.81it/s] 28%|██▊       | 166/585 [00:44<01:48,  3.86it/s] 29%|██▊       | 167/585 [00:44<01:47,  3.87it/s] 29%|██▊       | 168/585 [00:44<01:47,  3.86it/s] 29%|██▉       | 169/585 [00:44<01:47,  3.86it/s] 29%|██▉       | 170/585 [00:45<01:47,  3.85it/s]                                                 {'loss': 0.27, 'grad_norm': 4.433221340179443, 'learning_rate': 1.69e-05, 'epoch': 0.87}
 29%|██▉       | 170/585 [00:45<01:47,  3.85it/s] 29%|██▉       | 171/585 [00:45<01:48,  3.82it/s] 29%|██▉       | 172/585 [00:45<01:48,  3.80it/s] 30%|██▉       | 173/585 [00:46<01:48,  3.79it/s] 30%|██▉       | 174/585 [00:46<01:50,  3.71it/s] 30%|██▉       | 175/585 [00:46<02:10,  3.15it/s] 30%|███       | 176/585 [00:47<02:02,  3.33it/s] 30%|███       | 177/585 [00:47<01:58,  3.45it/s] 30%|███       | 178/585 [00:47<01:56,  3.50it/s] 31%|███       | 179/585 [00:47<01:52,  3.60it/s] 31%|███       | 180/585 [00:48<01:49,  3.69it/s]                                                 {'loss': 0.2705, 'grad_norm': 4.079005718231201, 'learning_rate': 1.79e-05, 'epoch': 0.92}
 31%|███       | 180/585 [00:48<01:49,  3.69it/s] 31%|███       | 181/585 [00:48<01:50,  3.67it/s] 31%|███       | 182/585 [00:48<01:47,  3.74it/s] 31%|███▏      | 183/585 [00:48<01:47,  3.75it/s] 31%|███▏      | 184/585 [00:49<01:45,  3.82it/s] 32%|███▏      | 185/585 [00:49<01:43,  3.85it/s] 32%|███▏      | 186/585 [00:49<01:42,  3.88it/s] 32%|███▏      | 187/585 [00:49<01:42,  3.89it/s] 32%|███▏      | 188/585 [00:50<01:42,  3.86it/s] 32%|███▏      | 189/585 [00:50<01:42,  3.87it/s] 32%|███▏      | 190/585 [00:50<01:42,  3.84it/s]                                                 {'loss': 0.272, 'grad_norm': 7.032376289367676, 'learning_rate': 1.8900000000000002e-05, 'epoch': 0.97}
 32%|███▏      | 190/585 [00:50<01:42,  3.84it/s] 33%|███▎      | 191/585 [00:50<01:44,  3.77it/s] 33%|███▎      | 192/585 [00:51<01:43,  3.80it/s] 33%|███▎      | 193/585 [00:51<01:42,  3.82it/s] 33%|███▎      | 194/585 [00:51<01:38,  3.97it/s] 33%|███▎      | 195/585 [00:51<01:27,  4.44it/s]
  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|█▌        | 2/13 [00:00<00:01,  6.42it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.44it/s][A
 31%|███       | 4/13 [00:00<00:02,  3.77it/s][A
 38%|███▊      | 5/13 [00:01<00:02,  3.46it/s][A
 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s][A
 54%|█████▍    | 7/13 [00:01<00:01,  3.23it/s][A
 62%|██████▏   | 8/13 [00:02<00:01,  3.10it/s][A
 69%|██████▉   | 9/13 [00:02<00:01,  3.08it/s][A
 77%|███████▋  | 10/13 [00:02<00:00,  3.05it/s][A
 85%|████████▍ | 11/13 [00:03<00:00,  3.01it/s][A
 92%|█████████▏| 12/13 [00:03<00:00,  3.35it/s][A                                                 
                                               [A{'eval_loss': 0.24193178117275238, 'eval_accuracy': 0.9001931745009659, 'eval_f1': 0.9265750828991, 'eval_precision': 0.9200376293508937, 'eval_recall': 0.933206106870229, 'eval_runtime': 4.0736, 'eval_samples_per_second': 381.233, 'eval_steps_per_second': 3.191, 'epoch': 1.0}
 33%|███▎      | 195/585 [00:55<01:27,  4.44it/s]
100%|██████████| 13/13 [00:03<00:00,  3.35it/s][A
                                               [A/home/dinghanchen/anaconda3/envs/nlp_project/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
 34%|███▎      | 196/585 [00:58<14:01,  2.16s/it] 34%|███▎      | 197/585 [00:58<10:18,  1.59s/it] 34%|███▍      | 198/585 [00:59<07:44,  1.20s/it] 34%|███▍      | 199/585 [00:59<05:55,  1.09it/s] 34%|███▍      | 200/585 [00:59<04:38,  1.38it/s]                                                 {'loss': 0.2386, 'grad_norm': 6.175620079040527, 'learning_rate': 1.9900000000000003e-05, 'epoch': 1.03}
 34%|███▍      | 200/585 [00:59<04:38,  1.38it/s] 34%|███▍      | 201/585 [00:59<03:45,  1.70it/s] 35%|███▍      | 202/585 [01:00<03:07,  2.04it/s] 35%|███▍      | 203/585 [01:00<02:41,  2.37it/s] 35%|███▍      | 204/585 [01:00<02:22,  2.67it/s] 35%|███▌      | 205/585 [01:00<02:08,  2.96it/s] 35%|███▌      | 206/585 [01:01<01:59,  3.18it/s] 35%|███▌      | 207/585 [01:01<01:54,  3.31it/s] 36%|███▌      | 208/585 [01:01<01:48,  3.46it/s] 36%|███▌      | 209/585 [01:01<01:44,  3.61it/s] 36%|███▌      | 210/585 [01:02<01:41,  3.71it/s]                                                 {'loss': 0.1708, 'grad_norm': 5.601123809814453, 'learning_rate': 2.09e-05, 'epoch': 1.08}
 36%|███▌      | 210/585 [01:02<01:41,  3.71it/s] 36%|███▌      | 211/585 [01:02<01:39,  3.75it/s] 36%|███▌      | 212/585 [01:02<01:38,  3.79it/s] 36%|███▋      | 213/585 [01:03<01:36,  3.84it/s] 37%|███▋      | 214/585 [01:03<01:36,  3.84it/s] 37%|███▋      | 215/585 [01:03<01:36,  3.85it/s] 37%|███▋      | 216/585 [01:03<01:36,  3.82it/s] 37%|███▋      | 217/585 [01:04<01:36,  3.81it/s] 37%|███▋      | 218/585 [01:04<01:35,  3.83it/s] 37%|███▋      | 219/585 [01:04<01:35,  3.85it/s] 38%|███▊      | 220/585 [01:04<01:35,  3.83it/s]                                                 {'loss': 0.2174, 'grad_norm': 3.9781339168548584, 'learning_rate': 2.19e-05, 'epoch': 1.13}
 38%|███▊      | 220/585 [01:04<01:35,  3.83it/s] 38%|███▊      | 221/585 [01:05<01:35,  3.83it/s] 38%|███▊      | 222/585 [01:05<01:34,  3.83it/s] 38%|███▊      | 223/585 [01:05<01:35,  3.81it/s] 38%|███▊      | 224/585 [01:05<01:34,  3.82it/s] 38%|███▊      | 225/585 [01:06<01:34,  3.81it/s] 39%|███▊      | 226/585 [01:06<01:34,  3.80it/s] 39%|███▉      | 227/585 [01:06<01:33,  3.85it/s] 39%|███▉      | 228/585 [01:06<01:33,  3.83it/s] 39%|███▉      | 229/585 [01:07<01:32,  3.83it/s] 39%|███▉      | 230/585 [01:07<01:32,  3.83it/s]                                                 {'loss': 0.2236, 'grad_norm': 3.0983734130859375, 'learning_rate': 2.29e-05, 'epoch': 1.18}
 39%|███▉      | 230/585 [01:07<01:32,  3.83it/s] 39%|███▉      | 231/585 [01:07<01:31,  3.85it/s] 40%|███▉      | 232/585 [01:07<01:32,  3.83it/s] 40%|███▉      | 233/585 [01:08<01:32,  3.81it/s] 40%|████      | 234/585 [01:08<01:32,  3.80it/s] 40%|████      | 235/585 [01:08<01:31,  3.84it/s] 40%|████      | 236/585 [01:09<01:30,  3.85it/s] 41%|████      | 237/585 [01:09<01:31,  3.79it/s] 41%|████      | 238/585 [01:09<01:30,  3.83it/s] 41%|████      | 239/585 [01:09<01:30,  3.81it/s] 41%|████      | 240/585 [01:10<01:30,  3.82it/s]                                                 {'loss': 0.2233, 'grad_norm': 3.988431930541992, 'learning_rate': 2.39e-05, 'epoch': 1.23}
 41%|████      | 240/585 [01:10<01:30,  3.82it/s] 41%|████      | 241/585 [01:10<01:30,  3.80it/s] 41%|████▏     | 242/585 [01:10<01:29,  3.85it/s] 42%|████▏     | 243/585 [01:10<01:29,  3.83it/s] 42%|████▏     | 244/585 [01:11<01:29,  3.82it/s] 42%|████▏     | 245/585 [01:11<01:29,  3.79it/s] 42%|████▏     | 246/585 [01:11<01:29,  3.78it/s] 42%|████▏     | 247/585 [01:11<01:29,  3.78it/s] 42%|████▏     | 248/585 [01:12<01:29,  3.77it/s] 43%|████▎     | 249/585 [01:12<01:28,  3.81it/s] 43%|████▎     | 250/585 [01:12<01:26,  3.85it/s]                                                 {'loss': 0.2435, 'grad_norm': 7.363372802734375, 'learning_rate': 2.4900000000000002e-05, 'epoch': 1.28}
 43%|████▎     | 250/585 [01:12<01:26,  3.85it/s] 43%|████▎     | 251/585 [01:12<01:26,  3.88it/s] 43%|████▎     | 252/585 [01:13<01:25,  3.91it/s] 43%|████▎     | 253/585 [01:13<01:25,  3.89it/s] 43%|████▎     | 254/585 [01:13<01:24,  3.90it/s] 44%|████▎     | 255/585 [01:13<01:24,  3.90it/s] 44%|████▍     | 256/585 [01:14<01:24,  3.89it/s] 44%|████▍     | 257/585 [01:14<01:24,  3.88it/s] 44%|████▍     | 258/585 [01:14<01:24,  3.89it/s] 44%|████▍     | 259/585 [01:15<01:24,  3.86it/s] 44%|████▍     | 260/585 [01:15<01:24,  3.87it/s]                                                 {'loss': 0.2161, 'grad_norm': 7.655797958374023, 'learning_rate': 2.5900000000000003e-05, 'epoch': 1.33}
 44%|████▍     | 260/585 [01:15<01:24,  3.87it/s] 45%|████▍     | 261/585 [01:15<01:23,  3.87it/s] 45%|████▍     | 262/585 [01:15<01:23,  3.87it/s] 45%|████▍     | 263/585 [01:16<01:23,  3.85it/s] 45%|████▌     | 264/585 [01:16<01:23,  3.86it/s] 45%|████▌     | 265/585 [01:16<01:23,  3.85it/s] 45%|████▌     | 266/585 [01:16<01:23,  3.81it/s] 46%|████▌     | 267/585 [01:17<01:23,  3.80it/s] 46%|████▌     | 268/585 [01:17<01:23,  3.80it/s] 46%|████▌     | 269/585 [01:17<01:23,  3.80it/s] 46%|████▌     | 270/585 [01:17<01:22,  3.80it/s]                                                 {'loss': 0.3131, 'grad_norm': 5.658627510070801, 'learning_rate': 2.6900000000000003e-05, 'epoch': 1.38}
 46%|████▌     | 270/585 [01:17<01:22,  3.80it/s] 46%|████▋     | 271/585 [01:18<01:22,  3.82it/s] 46%|████▋     | 272/585 [01:18<01:22,  3.80it/s] 47%|████▋     | 273/585 [01:18<01:22,  3.79it/s] 47%|████▋     | 274/585 [01:18<01:21,  3.81it/s] 47%|████▋     | 275/585 [01:19<01:20,  3.83it/s] 47%|████▋     | 276/585 [01:19<01:20,  3.85it/s] 47%|████▋     | 277/585 [01:19<01:20,  3.84it/s] 48%|████▊     | 278/585 [01:19<01:19,  3.84it/s] 48%|████▊     | 279/585 [01:20<01:18,  3.88it/s] 48%|████▊     | 280/585 [01:20<01:18,  3.87it/s]                                                 {'loss': 0.2377, 'grad_norm': 3.445145606994629, 'learning_rate': 2.7900000000000004e-05, 'epoch': 1.44}
 48%|████▊     | 280/585 [01:20<01:18,  3.87it/s] 48%|████▊     | 281/585 [01:20<01:18,  3.86it/s] 48%|████▊     | 282/585 [01:21<01:18,  3.84it/s] 48%|████▊     | 283/585 [01:21<01:18,  3.84it/s] 49%|████▊     | 284/585 [01:21<01:18,  3.83it/s] 49%|████▊     | 285/585 [01:21<01:18,  3.84it/s] 49%|████▉     | 286/585 [01:22<01:17,  3.85it/s] 49%|████▉     | 287/585 [01:22<01:17,  3.86it/s] 49%|████▉     | 288/585 [01:22<01:16,  3.88it/s] 49%|████▉     | 289/585 [01:22<01:15,  3.91it/s] 50%|████▉     | 290/585 [01:23<01:15,  3.89it/s]                                                 {'loss': 0.2787, 'grad_norm': 14.201143264770508, 'learning_rate': 2.8899999999999998e-05, 'epoch': 1.49}
 50%|████▉     | 290/585 [01:23<01:15,  3.89it/s] 50%|████▉     | 291/585 [01:23<01:14,  3.94it/s] 50%|████▉     | 292/585 [01:23<01:14,  3.93it/s] 50%|█████     | 293/585 [01:23<01:15,  3.89it/s] 50%|█████     | 294/585 [01:24<01:14,  3.92it/s] 50%|█████     | 295/585 [01:24<01:14,  3.88it/s] 51%|█████     | 296/585 [01:24<01:14,  3.88it/s] 51%|█████     | 297/585 [01:24<01:14,  3.85it/s] 51%|█████     | 298/585 [01:25<01:14,  3.87it/s] 51%|█████     | 299/585 [01:25<01:14,  3.84it/s] 51%|█████▏    | 300/585 [01:25<01:14,  3.83it/s]                                                 {'loss': 0.2223, 'grad_norm': 8.176956176757812, 'learning_rate': 2.9900000000000002e-05, 'epoch': 1.54}
 51%|█████▏    | 300/585 [01:25<01:14,  3.83it/s] 51%|█████▏    | 301/585 [01:25<01:13,  3.84it/s] 52%|█████▏    | 302/585 [01:26<01:13,  3.87it/s] 52%|█████▏    | 303/585 [01:26<01:12,  3.88it/s] 52%|█████▏    | 304/585 [01:26<01:12,  3.88it/s] 52%|█████▏    | 305/585 [01:26<01:11,  3.90it/s] 52%|█████▏    | 306/585 [01:27<01:12,  3.83it/s] 52%|█████▏    | 307/585 [01:27<01:12,  3.85it/s] 53%|█████▎    | 308/585 [01:27<01:13,  3.79it/s] 53%|█████▎    | 309/585 [01:27<01:12,  3.79it/s] 53%|█████▎    | 310/585 [01:28<01:12,  3.78it/s]                                                 {'loss': 0.189, 'grad_norm': 2.80297589302063, 'learning_rate': 3.09e-05, 'epoch': 1.59}
 53%|█████▎    | 310/585 [01:28<01:12,  3.78it/s] 53%|█████▎    | 311/585 [01:28<01:11,  3.82it/s] 53%|█████▎    | 312/585 [01:28<01:10,  3.87it/s] 54%|█████▎    | 313/585 [01:29<01:10,  3.84it/s] 54%|█████▎    | 314/585 [01:29<01:10,  3.87it/s] 54%|█████▍    | 315/585 [01:29<01:10,  3.84it/s] 54%|█████▍    | 316/585 [01:29<01:09,  3.85it/s] 54%|█████▍    | 317/585 [01:30<01:09,  3.87it/s] 54%|█████▍    | 318/585 [01:30<01:08,  3.88it/s] 55%|█████▍    | 319/585 [01:30<01:08,  3.87it/s] 55%|█████▍    | 320/585 [01:30<01:08,  3.89it/s]                                                 {'loss': 0.2742, 'grad_norm': 5.993099689483643, 'learning_rate': 3.19e-05, 'epoch': 1.64}
 55%|█████▍    | 320/585 [01:30<01:08,  3.89it/s] 55%|█████▍    | 321/585 [01:31<01:07,  3.92it/s] 55%|█████▌    | 322/585 [01:31<01:08,  3.86it/s] 55%|█████▌    | 323/585 [01:31<01:07,  3.85it/s] 55%|█████▌    | 324/585 [01:31<01:09,  3.77it/s] 56%|█████▌    | 325/585 [01:32<01:08,  3.82it/s] 56%|█████▌    | 326/585 [01:32<01:07,  3.81it/s] 56%|█████▌    | 327/585 [01:32<01:07,  3.85it/s] 56%|█████▌    | 328/585 [01:32<01:07,  3.81it/s] 56%|█████▌    | 329/585 [01:33<01:07,  3.80it/s] 56%|█████▋    | 330/585 [01:33<01:07,  3.80it/s]                                                 {'loss': 0.2327, 'grad_norm': 7.621837615966797, 'learning_rate': 3.29e-05, 'epoch': 1.69}
 56%|█████▋    | 330/585 [01:33<01:07,  3.80it/s] 57%|█████▋    | 331/585 [01:33<01:07,  3.78it/s] 57%|█████▋    | 332/585 [01:33<01:06,  3.79it/s] 57%|█████▋    | 333/585 [01:34<01:05,  3.83it/s] 57%|█████▋    | 334/585 [01:34<01:04,  3.88it/s] 57%|█████▋    | 335/585 [01:34<01:04,  3.90it/s] 57%|█████▋    | 336/585 [01:35<01:04,  3.87it/s] 58%|█████▊    | 337/585 [01:35<01:03,  3.90it/s] 58%|█████▊    | 338/585 [01:35<01:03,  3.88it/s] 58%|█████▊    | 339/585 [01:35<01:04,  3.81it/s] 58%|█████▊    | 340/585 [01:36<01:04,  3.82it/s]                                                 {'loss': 0.2481, 'grad_norm': 6.9932966232299805, 'learning_rate': 3.3900000000000004e-05, 'epoch': 1.74}
 58%|█████▊    | 340/585 [01:36<01:04,  3.82it/s] 58%|█████▊    | 341/585 [01:36<01:17,  3.16it/s] 58%|█████▊    | 342/585 [01:36<01:13,  3.32it/s] 59%|█████▊    | 343/585 [01:37<01:10,  3.46it/s] 59%|█████▉    | 344/585 [01:37<01:07,  3.59it/s] 59%|█████▉    | 345/585 [01:37<01:05,  3.66it/s] 59%|█████▉    | 346/585 [01:37<01:04,  3.71it/s] 59%|█████▉    | 347/585 [01:38<01:03,  3.73it/s] 59%|█████▉    | 348/585 [01:38<01:04,  3.69it/s] 60%|█████▉    | 349/585 [01:38<01:03,  3.71it/s] 60%|█████▉    | 350/585 [01:38<01:02,  3.78it/s]                                                 {'loss': 0.2404, 'grad_norm': 5.551758289337158, 'learning_rate': 3.49e-05, 'epoch': 1.79}
 60%|█████▉    | 350/585 [01:38<01:02,  3.78it/s] 60%|██████    | 351/585 [01:39<01:01,  3.80it/s] 60%|██████    | 352/585 [01:39<01:01,  3.80it/s] 60%|██████    | 353/585 [01:39<01:00,  3.83it/s] 61%|██████    | 354/585 [01:39<01:00,  3.81it/s] 61%|██████    | 355/585 [01:40<00:59,  3.83it/s] 61%|██████    | 356/585 [01:40<00:59,  3.84it/s] 61%|██████    | 357/585 [01:40<00:59,  3.81it/s] 61%|██████    | 358/585 [01:40<00:59,  3.83it/s] 61%|██████▏   | 359/585 [01:41<00:58,  3.86it/s] 62%|██████▏   | 360/585 [01:41<00:58,  3.85it/s]                                                 {'loss': 0.2301, 'grad_norm': 9.05246639251709, 'learning_rate': 3.59e-05, 'epoch': 1.85}
 62%|██████▏   | 360/585 [01:41<00:58,  3.85it/s] 62%|██████▏   | 361/585 [01:41<00:58,  3.84it/s] 62%|██████▏   | 362/585 [01:41<00:57,  3.86it/s] 62%|██████▏   | 363/585 [01:42<00:57,  3.84it/s] 62%|██████▏   | 364/585 [01:42<00:57,  3.84it/s] 62%|██████▏   | 365/585 [01:42<00:56,  3.86it/s] 63%|██████▎   | 366/585 [01:43<00:56,  3.90it/s] 63%|██████▎   | 367/585 [01:43<00:56,  3.89it/s] 63%|██████▎   | 368/585 [01:43<00:55,  3.90it/s] 63%|██████▎   | 369/585 [01:43<00:55,  3.87it/s] 63%|██████▎   | 370/585 [01:44<00:55,  3.90it/s]                                                 {'loss': 0.2083, 'grad_norm': 6.305424213409424, 'learning_rate': 3.69e-05, 'epoch': 1.9}
 63%|██████▎   | 370/585 [01:44<00:55,  3.90it/s] 63%|██████▎   | 371/585 [01:44<00:54,  3.90it/s] 64%|██████▎   | 372/585 [01:44<00:54,  3.91it/s] 64%|██████▍   | 373/585 [01:44<00:54,  3.87it/s] 64%|██████▍   | 374/585 [01:45<00:54,  3.86it/s] 64%|██████▍   | 375/585 [01:45<00:54,  3.84it/s] 64%|██████▍   | 376/585 [01:45<00:54,  3.82it/s] 64%|██████▍   | 377/585 [01:45<00:54,  3.84it/s] 65%|██████▍   | 378/585 [01:46<00:54,  3.80it/s] 65%|██████▍   | 379/585 [01:46<00:54,  3.79it/s] 65%|██████▍   | 380/585 [01:46<00:54,  3.79it/s]                                                 {'loss': 0.2521, 'grad_norm': 4.763728618621826, 'learning_rate': 3.79e-05, 'epoch': 1.95}
 65%|██████▍   | 380/585 [01:46<00:54,  3.79it/s] 65%|██████▌   | 381/585 [01:46<00:53,  3.81it/s] 65%|██████▌   | 382/585 [01:47<00:52,  3.84it/s] 65%|██████▌   | 383/585 [01:47<00:52,  3.83it/s] 66%|██████▌   | 384/585 [01:47<00:52,  3.81it/s] 66%|██████▌   | 385/585 [01:47<00:52,  3.83it/s] 66%|██████▌   | 386/585 [01:48<00:51,  3.86it/s] 66%|██████▌   | 387/585 [01:48<00:51,  3.86it/s] 66%|██████▋   | 388/585 [01:48<00:51,  3.85it/s] 66%|██████▋   | 389/585 [01:48<00:49,  3.96it/s] 67%|██████▋   | 390/585 [01:49<00:42,  4.56it/s]                                                 {'loss': 0.2242, 'grad_norm': 15.923206329345703, 'learning_rate': 3.8900000000000004e-05, 'epoch': 2.0}
 67%|██████▋   | 390/585 [01:49<00:42,  4.56it/s]
  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|█▌        | 2/13 [00:00<00:01,  6.42it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.47it/s][A
 31%|███       | 4/13 [00:00<00:02,  3.80it/s][A
 38%|███▊      | 5/13 [00:01<00:02,  3.52it/s][A
 46%|████▌     | 6/13 [00:01<00:02,  3.34it/s][A
 54%|█████▍    | 7/13 [00:01<00:01,  3.27it/s][A
 62%|██████▏   | 8/13 [00:02<00:01,  3.12it/s][A
 69%|██████▉   | 9/13 [00:02<00:01,  3.11it/s][A
 77%|███████▋  | 10/13 [00:02<00:00,  3.08it/s][A
 85%|████████▍ | 11/13 [00:03<00:00,  3.04it/s][A
 92%|█████████▏| 12/13 [00:03<00:00,  3.38it/s][A                                                 
                                               [A{'eval_loss': 0.2731018364429474, 'eval_accuracy': 0.8989053444945267, 'eval_f1': 0.9256980596308566, 'eval_precision': 0.9183098591549296, 'eval_recall': 0.933206106870229, 'eval_runtime': 4.0321, 'eval_samples_per_second': 385.163, 'eval_steps_per_second': 3.224, 'epoch': 2.0}
 67%|██████▋   | 390/585 [01:53<00:42,  4.56it/s]
100%|██████████| 13/13 [00:03<00:00,  3.38it/s][A
                                               [A/home/dinghanchen/anaconda3/envs/nlp_project/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
 67%|██████▋   | 391/585 [01:55<07:01,  2.17s/it] 67%|██████▋   | 392/585 [01:56<05:09,  1.60s/it] 67%|██████▋   | 393/585 [01:56<03:50,  1.20s/it] 67%|██████▋   | 394/585 [01:56<02:55,  1.09it/s] 68%|██████▊   | 395/585 [01:56<02:16,  1.39it/s] 68%|██████▊   | 396/585 [01:57<01:49,  1.73it/s] 68%|██████▊   | 397/585 [01:57<01:31,  2.05it/s] 68%|██████▊   | 398/585 [01:57<01:18,  2.39it/s] 68%|██████▊   | 399/585 [01:57<01:08,  2.70it/s] 68%|██████▊   | 400/585 [01:58<01:02,  2.97it/s]                                                 {'loss': 0.0871, 'grad_norm': 9.875089645385742, 'learning_rate': 3.99e-05, 'epoch': 2.05}
 68%|██████▊   | 400/585 [01:58<01:02,  2.97it/s] 69%|██████▊   | 401/585 [01:58<00:57,  3.18it/s] 69%|██████▊   | 402/585 [01:58<00:55,  3.32it/s] 69%|██████▉   | 403/585 [01:58<00:52,  3.46it/s] 69%|██████▉   | 404/585 [01:59<00:51,  3.54it/s] 69%|██████▉   | 405/585 [01:59<00:49,  3.61it/s] 69%|██████▉   | 406/585 [01:59<00:48,  3.66it/s] 70%|██████▉   | 407/585 [02:00<00:48,  3.69it/s] 70%|██████▉   | 408/585 [02:00<00:47,  3.74it/s] 70%|██████▉   | 409/585 [02:00<00:46,  3.76it/s] 70%|███████   | 410/585 [02:00<00:46,  3.79it/s]                                                 {'loss': 0.3008, 'grad_norm': 4.192200183868408, 'learning_rate': 4.09e-05, 'epoch': 2.1}
 70%|███████   | 410/585 [02:00<00:46,  3.79it/s] 70%|███████   | 411/585 [02:01<00:45,  3.81it/s] 70%|███████   | 412/585 [02:01<00:45,  3.82it/s] 71%|███████   | 413/585 [02:01<00:45,  3.80it/s] 71%|███████   | 414/585 [02:01<00:44,  3.81it/s] 71%|███████   | 415/585 [02:02<00:44,  3.84it/s] 71%|███████   | 416/585 [02:02<00:44,  3.80it/s] 71%|███████▏  | 417/585 [02:02<00:43,  3.83it/s] 71%|███████▏  | 418/585 [02:02<00:43,  3.80it/s] 72%|███████▏  | 419/585 [02:03<00:43,  3.78it/s] 72%|███████▏  | 420/585 [02:03<00:43,  3.78it/s]                                                 {'loss': 0.2043, 'grad_norm': 4.973293304443359, 'learning_rate': 4.19e-05, 'epoch': 2.15}
 72%|███████▏  | 420/585 [02:03<00:43,  3.78it/s] 72%|███████▏  | 421/585 [02:03<00:43,  3.76it/s] 72%|███████▏  | 422/585 [02:03<00:42,  3.80it/s] 72%|███████▏  | 423/585 [02:04<00:42,  3.81it/s] 72%|███████▏  | 424/585 [02:04<00:42,  3.79it/s] 73%|███████▎  | 425/585 [02:04<00:42,  3.74it/s] 73%|███████▎  | 426/585 [02:05<00:41,  3.79it/s] 73%|███████▎  | 427/585 [02:05<00:41,  3.81it/s] 73%|███████▎  | 428/585 [02:05<00:41,  3.81it/s] 73%|███████▎  | 429/585 [02:05<00:41,  3.79it/s] 74%|███████▎  | 430/585 [02:06<00:40,  3.79it/s]                                                 {'loss': 0.1833, 'grad_norm': 16.86853790283203, 'learning_rate': 4.29e-05, 'epoch': 2.21}
 74%|███████▎  | 430/585 [02:06<00:40,  3.79it/s] 74%|███████▎  | 431/585 [02:06<00:40,  3.76it/s] 74%|███████▍  | 432/585 [02:06<00:40,  3.76it/s] 74%|███████▍  | 433/585 [02:06<00:39,  3.82it/s] 74%|███████▍  | 434/585 [02:07<00:39,  3.78it/s] 74%|███████▍  | 435/585 [02:07<00:39,  3.78it/s] 75%|███████▍  | 436/585 [02:07<00:39,  3.79it/s] 75%|███████▍  | 437/585 [02:07<00:38,  3.85it/s] 75%|███████▍  | 438/585 [02:08<00:38,  3.83it/s] 75%|███████▌  | 439/585 [02:08<00:37,  3.86it/s] 75%|███████▌  | 440/585 [02:08<00:37,  3.85it/s]                                                 {'loss': 0.15, 'grad_norm': 3.9879839420318604, 'learning_rate': 4.39e-05, 'epoch': 2.26}
 75%|███████▌  | 440/585 [02:08<00:37,  3.85it/s] 75%|███████▌  | 441/585 [02:08<00:37,  3.84it/s] 76%|███████▌  | 442/585 [02:09<00:37,  3.86it/s] 76%|███████▌  | 443/585 [02:09<00:37,  3.83it/s] 76%|███████▌  | 444/585 [02:09<00:36,  3.84it/s] 76%|███████▌  | 445/585 [02:10<00:36,  3.84it/s] 76%|███████▌  | 446/585 [02:10<00:37,  3.76it/s] 76%|███████▋  | 447/585 [02:10<00:36,  3.73it/s] 77%|███████▋  | 448/585 [02:10<00:36,  3.75it/s] 77%|███████▋  | 449/585 [02:11<00:36,  3.74it/s] 77%|███████▋  | 450/585 [02:11<00:35,  3.79it/s]                                                 {'loss': 0.2053, 'grad_norm': 6.199512958526611, 'learning_rate': 4.49e-05, 'epoch': 2.31}
 77%|███████▋  | 450/585 [02:11<00:35,  3.79it/s] 77%|███████▋  | 451/585 [02:11<00:35,  3.81it/s] 77%|███████▋  | 452/585 [02:11<00:34,  3.83it/s] 77%|███████▋  | 453/585 [02:12<00:34,  3.82it/s] 78%|███████▊  | 454/585 [02:12<00:33,  3.87it/s] 78%|███████▊  | 455/585 [02:12<00:33,  3.87it/s] 78%|███████▊  | 456/585 [02:12<00:33,  3.85it/s] 78%|███████▊  | 457/585 [02:13<00:32,  3.89it/s] 78%|███████▊  | 458/585 [02:13<00:32,  3.89it/s] 78%|███████▊  | 459/585 [02:13<00:32,  3.91it/s] 79%|███████▊  | 460/585 [02:13<00:32,  3.88it/s]                                                 {'loss': 0.2315, 'grad_norm': 2.710846424102783, 'learning_rate': 4.5900000000000004e-05, 'epoch': 2.36}
 79%|███████▊  | 460/585 [02:13<00:32,  3.88it/s] 79%|███████▉  | 461/585 [02:14<00:31,  3.89it/s] 79%|███████▉  | 462/585 [02:14<00:31,  3.93it/s] 79%|███████▉  | 463/585 [02:14<00:30,  3.97it/s] 79%|███████▉  | 464/585 [02:14<00:31,  3.88it/s] 79%|███████▉  | 465/585 [02:15<00:31,  3.86it/s] 80%|███████▉  | 466/585 [02:15<00:30,  3.86it/s] 80%|███████▉  | 467/585 [02:15<00:30,  3.88it/s] 80%|████████  | 468/585 [02:15<00:30,  3.87it/s] 80%|████████  | 469/585 [02:16<00:29,  3.88it/s] 80%|████████  | 470/585 [02:16<00:29,  3.84it/s]                                                 {'loss': 0.1996, 'grad_norm': 5.495548725128174, 'learning_rate': 4.69e-05, 'epoch': 2.41}
 80%|████████  | 470/585 [02:16<00:29,  3.84it/s] 81%|████████  | 471/585 [02:16<00:29,  3.83it/s] 81%|████████  | 472/585 [02:17<00:29,  3.86it/s] 81%|████████  | 473/585 [02:17<00:29,  3.85it/s] 81%|████████  | 474/585 [02:17<00:29,  3.82it/s] 81%|████████  | 475/585 [02:17<00:29,  3.79it/s] 81%|████████▏ | 476/585 [02:18<00:28,  3.87it/s] 82%|████████▏ | 477/585 [02:18<00:27,  3.86it/s] 82%|████████▏ | 478/585 [02:18<00:27,  3.88it/s] 82%|████████▏ | 479/585 [02:18<00:27,  3.91it/s] 82%|████████▏ | 480/585 [02:19<00:26,  3.92it/s]                                                 {'loss': 0.1375, 'grad_norm': 3.9363906383514404, 'learning_rate': 4.79e-05, 'epoch': 2.46}
 82%|████████▏ | 480/585 [02:19<00:26,  3.92it/s] 82%|████████▏ | 481/585 [02:19<00:26,  3.92it/s] 82%|████████▏ | 482/585 [02:19<00:26,  3.83it/s] 83%|████████▎ | 483/585 [02:19<00:26,  3.80it/s] 83%|████████▎ | 484/585 [02:20<00:26,  3.80it/s] 83%|████████▎ | 485/585 [02:20<00:26,  3.80it/s] 83%|████████▎ | 486/585 [02:20<00:26,  3.78it/s] 83%|████████▎ | 487/585 [02:20<00:25,  3.81it/s] 83%|████████▎ | 488/585 [02:21<00:25,  3.80it/s] 84%|████████▎ | 489/585 [02:21<00:25,  3.79it/s] 84%|████████▍ | 490/585 [02:21<00:25,  3.80it/s]                                                 {'loss': 0.1324, 'grad_norm': 6.634007930755615, 'learning_rate': 4.89e-05, 'epoch': 2.51}
 84%|████████▍ | 490/585 [02:21<00:25,  3.80it/s] 84%|████████▍ | 491/585 [02:21<00:24,  3.82it/s] 84%|████████▍ | 492/585 [02:22<00:24,  3.80it/s] 84%|████████▍ | 493/585 [02:22<00:23,  3.86it/s] 84%|████████▍ | 494/585 [02:22<00:23,  3.85it/s] 85%|████████▍ | 495/585 [02:23<00:23,  3.87it/s] 85%|████████▍ | 496/585 [02:23<00:23,  3.87it/s] 85%|████████▍ | 497/585 [02:23<00:22,  3.87it/s] 85%|████████▌ | 498/585 [02:23<00:22,  3.89it/s] 85%|████████▌ | 499/585 [02:24<00:22,  3.85it/s] 85%|████████▌ | 500/585 [02:24<00:22,  3.84it/s]                                                 {'loss': 0.2156, 'grad_norm': 13.673130989074707, 'learning_rate': 4.99e-05, 'epoch': 2.56}
 85%|████████▌ | 500/585 [02:24<00:22,  3.84it/s] 86%|████████▌ | 501/585 [02:24<00:21,  3.85it/s] 86%|████████▌ | 502/585 [02:24<00:21,  3.89it/s] 86%|████████▌ | 503/585 [02:25<00:21,  3.88it/s] 86%|████████▌ | 504/585 [02:25<00:21,  3.85it/s] 86%|████████▋ | 505/585 [02:25<00:20,  3.87it/s] 86%|████████▋ | 506/585 [02:25<00:20,  3.91it/s] 87%|████████▋ | 507/585 [02:26<00:24,  3.24it/s] 87%|████████▋ | 508/585 [02:26<00:22,  3.41it/s] 87%|████████▋ | 509/585 [02:26<00:21,  3.53it/s] 87%|████████▋ | 510/585 [02:27<00:20,  3.60it/s]                                                 {'loss': 0.2247, 'grad_norm': 7.319622039794922, 'learning_rate': 4.470588235294118e-05, 'epoch': 2.62}
 87%|████████▋ | 510/585 [02:27<00:20,  3.60it/s] 87%|████████▋ | 511/585 [02:27<00:20,  3.67it/s] 88%|████████▊ | 512/585 [02:27<00:19,  3.72it/s] 88%|████████▊ | 513/585 [02:27<00:19,  3.77it/s] 88%|████████▊ | 514/585 [02:28<00:18,  3.77it/s] 88%|████████▊ | 515/585 [02:28<00:18,  3.80it/s] 88%|████████▊ | 516/585 [02:28<00:18,  3.77it/s] 88%|████████▊ | 517/585 [02:28<00:17,  3.81it/s] 89%|████████▊ | 518/585 [02:29<00:17,  3.82it/s] 89%|████████▊ | 519/585 [02:29<00:17,  3.84it/s] 89%|████████▉ | 520/585 [02:29<00:16,  3.84it/s]                                                 {'loss': 0.229, 'grad_norm': 6.824033260345459, 'learning_rate': 3.882352941176471e-05, 'epoch': 2.67}
 89%|████████▉ | 520/585 [02:29<00:16,  3.84it/s] 89%|████████▉ | 521/585 [02:29<00:16,  3.82it/s] 89%|████████▉ | 522/585 [02:30<00:16,  3.86it/s] 89%|████████▉ | 523/585 [02:30<00:15,  3.89it/s] 90%|████████▉ | 524/585 [02:30<00:15,  3.89it/s] 90%|████████▉ | 525/585 [02:30<00:15,  3.91it/s] 90%|████████▉ | 526/585 [02:31<00:15,  3.91it/s] 90%|█████████ | 527/585 [02:31<00:14,  3.91it/s] 90%|█████████ | 528/585 [02:31<00:14,  3.91it/s] 90%|█████████ | 529/585 [02:31<00:14,  3.81it/s] 91%|█████████ | 530/585 [02:32<00:14,  3.83it/s]                                                 {'loss': 0.198, 'grad_norm': 5.56508207321167, 'learning_rate': 3.294117647058824e-05, 'epoch': 2.72}
 91%|█████████ | 530/585 [02:32<00:14,  3.83it/s] 91%|█████████ | 531/585 [02:32<00:14,  3.84it/s] 91%|█████████ | 532/585 [02:32<00:13,  3.82it/s] 91%|█████████ | 533/585 [02:33<00:13,  3.86it/s] 91%|█████████▏| 534/585 [02:33<00:13,  3.83it/s] 91%|█████████▏| 535/585 [02:33<00:12,  3.85it/s] 92%|█████████▏| 536/585 [02:33<00:12,  3.86it/s] 92%|█████████▏| 537/585 [02:34<00:12,  3.87it/s] 92%|█████████▏| 538/585 [02:34<00:12,  3.88it/s] 92%|█████████▏| 539/585 [02:34<00:11,  3.93it/s] 92%|█████████▏| 540/585 [02:34<00:11,  3.91it/s]                                                 {'loss': 0.1743, 'grad_norm': 2.0721099376678467, 'learning_rate': 2.7058823529411766e-05, 'epoch': 2.77}
 92%|█████████▏| 540/585 [02:34<00:11,  3.91it/s] 92%|█████████▏| 541/585 [02:35<00:11,  3.92it/s] 93%|█████████▎| 542/585 [02:35<00:10,  3.92it/s] 93%|█████████▎| 543/585 [02:35<00:10,  3.90it/s] 93%|█████████▎| 544/585 [02:35<00:10,  3.90it/s] 93%|█████████▎| 545/585 [02:36<00:10,  3.92it/s] 93%|█████████▎| 546/585 [02:36<00:09,  3.94it/s] 94%|█████████▎| 547/585 [02:36<00:09,  3.93it/s] 94%|█████████▎| 548/585 [02:36<00:09,  3.93it/s] 94%|█████████▍| 549/585 [02:37<00:09,  3.89it/s] 94%|█████████▍| 550/585 [02:37<00:09,  3.80it/s]                                                 {'loss': 0.2317, 'grad_norm': 10.680256843566895, 'learning_rate': 2.1176470588235296e-05, 'epoch': 2.82}
 94%|█████████▍| 550/585 [02:37<00:09,  3.80it/s] 94%|█████████▍| 551/585 [02:37<00:08,  3.80it/s] 94%|█████████▍| 552/585 [02:37<00:08,  3.83it/s] 95%|█████████▍| 553/585 [02:38<00:08,  3.88it/s] 95%|█████████▍| 554/585 [02:38<00:07,  3.90it/s] 95%|█████████▍| 555/585 [02:38<00:07,  3.89it/s] 95%|█████████▌| 556/585 [02:38<00:07,  3.89it/s] 95%|█████████▌| 557/585 [02:39<00:07,  3.91it/s] 95%|█████████▌| 558/585 [02:39<00:06,  3.90it/s] 96%|█████████▌| 559/585 [02:39<00:06,  3.84it/s] 96%|█████████▌| 560/585 [02:39<00:06,  3.89it/s]                                                 {'loss': 0.1722, 'grad_norm': 11.029352188110352, 'learning_rate': 1.5294117647058826e-05, 'epoch': 2.87}
 96%|█████████▌| 560/585 [02:39<00:06,  3.89it/s] 96%|█████████▌| 561/585 [02:40<00:06,  3.85it/s] 96%|█████████▌| 562/585 [02:40<00:05,  3.83it/s] 96%|█████████▌| 563/585 [02:40<00:05,  3.89it/s] 96%|█████████▋| 564/585 [02:41<00:05,  3.88it/s] 97%|█████████▋| 565/585 [02:41<00:05,  3.85it/s] 97%|█████████▋| 566/585 [02:41<00:04,  3.85it/s] 97%|█████████▋| 567/585 [02:41<00:04,  3.83it/s] 97%|█████████▋| 568/585 [02:42<00:04,  3.82it/s] 97%|█████████▋| 569/585 [02:42<00:04,  3.84it/s] 97%|█████████▋| 570/585 [02:42<00:03,  3.83it/s]                                                 {'loss': 0.1504, 'grad_norm': 4.891172885894775, 'learning_rate': 9.411764705882354e-06, 'epoch': 2.92}
 97%|█████████▋| 570/585 [02:42<00:03,  3.83it/s] 98%|█████████▊| 571/585 [02:42<00:03,  3.82it/s] 98%|█████████▊| 572/585 [02:43<00:03,  3.87it/s] 98%|█████████▊| 573/585 [02:43<00:03,  3.86it/s] 98%|█████████▊| 574/585 [02:43<00:02,  3.83it/s] 98%|█████████▊| 575/585 [02:43<00:02,  3.86it/s] 98%|█████████▊| 576/585 [02:44<00:02,  3.85it/s] 99%|█████████▊| 577/585 [02:44<00:02,  3.85it/s] 99%|█████████▉| 578/585 [02:44<00:01,  3.85it/s] 99%|█████████▉| 579/585 [02:44<00:01,  3.80it/s] 99%|█████████▉| 580/585 [02:45<00:01,  3.80it/s]                                                 {'loss': 0.1096, 'grad_norm': 5.6932148933410645, 'learning_rate': 3.5294117647058825e-06, 'epoch': 2.97}
 99%|█████████▉| 580/585 [02:45<00:01,  3.80it/s] 99%|█████████▉| 581/585 [02:45<00:01,  3.81it/s] 99%|█████████▉| 582/585 [02:45<00:00,  3.86it/s]100%|█████████▉| 583/585 [02:45<00:00,  3.85it/s]100%|█████████▉| 584/585 [02:46<00:00,  3.97it/s]100%|██████████| 585/585 [02:46<00:00,  4.63it/s]
  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|█▌        | 2/13 [00:00<00:01,  6.33it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.42it/s][A
 31%|███       | 4/13 [00:00<00:02,  3.78it/s][A
 38%|███▊      | 5/13 [00:01<00:02,  3.49it/s][A
 46%|████▌     | 6/13 [00:01<00:02,  3.38it/s][A
 54%|█████▍    | 7/13 [00:01<00:01,  3.32it/s][A
 62%|██████▏   | 8/13 [00:02<00:01,  3.18it/s][A
 69%|██████▉   | 9/13 [00:02<00:01,  3.15it/s][A
 77%|███████▋  | 10/13 [00:02<00:00,  3.11it/s][A
 85%|████████▍ | 11/13 [00:03<00:00,  3.06it/s][A
 92%|█████████▏| 12/13 [00:03<00:00,  3.39it/s][A                                                 
                                               [A{'eval_loss': 0.27690589427948, 'eval_accuracy': 0.9047005795235029, 'eval_f1': 0.9290508149568553, 'eval_precision': 0.9335260115606936, 'eval_recall': 0.924618320610687, 'eval_runtime': 4.0258, 'eval_samples_per_second': 385.762, 'eval_steps_per_second': 3.229, 'epoch': 3.0}
100%|██████████| 585/585 [02:50<00:00,  4.63it/s]
100%|██████████| 13/13 [00:03<00:00,  3.39it/s][A
                                               [A                                                 {'train_runtime': 172.9934, 'train_samples_per_second': 107.727, 'train_steps_per_second': 3.382, 'train_loss': 0.2874341318749974, 'epoch': 3.0}
100%|██████████| 585/585 [02:52<00:00,  4.63it/s]100%|██████████| 585/585 [02:52<00:00,  3.38it/s]
Evaluating the best model...
/home/dinghanchen/anaconda3/envs/nlp_project/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.38it/s] 23%|██▎       | 3/13 [00:00<00:02,  4.43it/s] 31%|███       | 4/13 [00:00<00:02,  3.77it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.46it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.29it/s] 54%|█████▍    | 7/13 [00:01<00:01,  3.24it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.10it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.07it/s] 77%|███████▋  | 10/13 [00:02<00:00,  3.04it/s] 85%|████████▍ | 11/13 [00:03<00:00,  2.99it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.33it/s]100%|██████████| 13/13 [00:03<00:00,  3.59it/s]
Evaluation results: {'eval_loss': 0.27690589427948, 'eval_accuracy': 0.9047005795235029, 'eval_f1': 0.9290508149568553, 'eval_precision': 0.9335260115606936, 'eval_recall': 0.924618320610687, 'eval_runtime': 4.0893, 'eval_samples_per_second': 379.77, 'eval_steps_per_second': 3.179, 'epoch': 3.0}
Saving the final model and tokenizer...
Training complete!
